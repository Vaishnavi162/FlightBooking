@model FlightBooking.Models.UserProfileViewModel
@{
    ViewBag.Title = "My Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-4">
    <div class="card shadow-lg p-4">
        <div class="row">
            <!-- Profile Picture -->
            <div class="col-md-4 text-center">
                <img src="@Model.User.ProfilePicture" alt="Profile Picture"
                     width="150" height="150" class="rounded-circle border shadow" />
                <h4 class="mt-3">@Model.User.UserName</h4>
            </div>

            <!-- User Details -->
            <div class="col-md-8">
                <h3 class="text-primary">Profile Details</h3>
                <hr />
                <p><b>Email:</b> @Model.User.Email</p>
                <p><b>Mobile:</b> @Model.User.Mobile</p>
                <p><b>Gender:</b> @Model.User.Gender</p>
                <p><b>State:</b> @Model.User.State</p>
                <p><b>City:</b> @Model.User.City</p>
            </div>
        </div>

        <div class="text-center mt-3">
            <a href="@Url.Action("EditProfile", "Account")" class="btn btn-warning">Edit Profile</a>
            <a href="@Url.Action("Index", "Home")" class="btn btn-secondary">Back to Home</a>
        </div>
    </div>

    <hr />
    <h3 class="text-success">My Bookings</h3>

    @if (Model.Bookings == null || !Model.Bookings.Any())
    {
        <div class="alert alert-warning">You have no bookings yet.</div>
    }
    else
    {
        <table class="table table-bordered table-hover mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Flight No</th>
                    <th>Airline</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Date</th>
                    <th>Seats</th>
                    <th>Total Price</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var booking in Model.Bookings)
                {
                    <tr>
                        <td>@booking.Flight.FlightNo</td>
                        <td>@booking.Flight.Airline</td>
                        <td>@booking.Flight.Departure</td>
                        <td>@booking.Flight.Destination</td>
                        <td>@Convert.ToDateTime(booking.Flight.Date).ToString("dd-MMM-yyyy")</td>
                        <td>@booking.Seats</td>
                        <td>₹@(booking.Seats * booking.Flight.Price)</td>
                        <td>
                           

                            @if (booking.Flight.Date > DateTime.Now)
                            {
                                <a href="@Url.Action("EditBooking", "Flights", new { id = booking.BookingId })"
                                   class="btn btn-warning btn-sm">Modify</a>

                                using (Html.BeginForm("CancelBooking", "Flights", FormMethod.Post))
                                {
                                    @Html.Hidden("bookingId", booking.BookingId)
                                    <button type="submit" class="btn btn-danger btn-sm"
                                            onclick="return confirm('Cancel this booking?');">
                                        Cancel
                                    </button>
                                }
                            }
                            else
                            {
                                <span class="text-muted">Completed</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
</div>
